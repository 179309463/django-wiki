{% extends "wiki/base.html" %}
{% load wiki_tags i18n sekizai_tags %}
{% load url from future %}

{% block pagetitle %}{% trans "Delete article" %}{% endblock %}

{% block wiki_contents %}
  <h1 class="page-header">{% trans "Delete" %} "{{ article.current_revision.title }}"</h1>
  
  {% if cannot_delete_root %}
    <p class="lead">{% trans "You cannot delete a root article." %}</p>
    <p><a href="{% url 'wiki:get' path=urlpath.path article_id=article.id %}">{% trans "Go back" %}</a></p>
  {% else %}
  
    {% if cannot_delete_children %}
      
      <p class="alert alert-error"><strong>{% trans "You cannot delete this article because you do not have permission to delete articles with children. Try to remove the children manually one-by-one." %}</strong></p>
      
    {% endif %}
      
    {% if children %}

      <p class="lead">{% trans "You are deleting an article. This means that its children will loose their connection to the rest of the tree and moved to Lost and Found. Only do this if you know what you're doing." %}</p>
      
      <h2>{% trans "Articles that will be orphans" %}</h2>
      
      <ul>
        {% for child in children %}
        <li><a href="{% url 'wiki:get' path=child.article.path %}" target="_blank">{{ child.article }}</a></li>
        {% endfor %}
      </ul>
    
    {% else %}
    
      <p class="lead">{% trans "You are deleting an article. Please confirm." %}</p>

    {% endif %}
    
    {% if not cannot_delete_children %}
    <form method="POST" class="form-horizontal">
      {% wiki_form delete_form %}
      <div class="form-actions">
          <a href="{% url 'wiki:get' path=urlpath.path article_id=article.id %}" class="btn btn-large">
            <span class="icon-circle-arrow-left"></span>
            {% trans "Go back" %}
          </a>
          <button type="submit" name="save_changes" class="btn btn-critical btn-large">
            <span class="icon-plus"></span>
            {% trans "Delete article" %}
          </button>
      </div>  
    </form>
    {% endif %}
 
  {% endif %}

{% endblock %}

