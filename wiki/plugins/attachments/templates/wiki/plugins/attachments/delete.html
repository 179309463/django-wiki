{% extends "wiki/base.html" %}
{% load wiki_tags i18n humanize %}
{% load url from future %}

{% block pagetitle %}{% trans "Delete" %} "{{ attachment.current_revision.get_filename }}"{% endblock %}

{% block wiki_breadcrumbs %}
  {% include "wiki/includes/breadcrumbs.html" %}
{% endblock %}

{% block wiki_contents %}

  {% article_for_object urlpath as article %}

  {% if article %}
    <div class="tabbable tabs-top" style="margin-top: 40px;">
      <ul class="nav nav-tabs">
        {% with "attachments" as selected %}
          {% include "wiki/includes/article_menu.html" %}
        {% endwith %}
        <li>
          <h1 style="margin-top: -10px;">
            {{ article.current_revision.title }}
          </h1>
        </li>
      </ul>
      <div class="tab-content">
        {% if attachment.article == article %}
        <h2>{% trans "Delete" %} "{{ attachment.current_revision.get_filename }}"?</h2>
          <p class="lead">
            {% blocktrans with attachment.original_filename as filename %}
            The file may be referenced on other articles. Deleting it means that they will loose their references to this file. The following articles reference this file:
            {% endblocktrans %}
          </p>
          <ul>
            {% for a in attachment.articles.all %}
              <li style="font-size: 150%;">{{ a.current_revision.title }}</li>
            {% endfor %}
          </ul>
        <hr />
        <form method="POST" class="form-horizontal" id="attachment_form" enctype="multipart/form-data">
          {% wiki_form form %}
          <div class="form-actions">
            <a href="{% url 'wiki:attachments_index' path=urlpath.path %}" class="btn">
              <span class="icon-arrow-left"></span>
              {% trans "Go back" %}
            </a>
            <button class="btn btn-danger btn-large">
              <span class="icon-upload"></span>
              {% trans "Delete it!" %}
            </button>
          </div>
        </form>
        
        {% else %}
          <h2>{% trans "Remove" %} "{{ attachment.current_revision.get_filename }}"?</h2>
          <p class="lead">
            {% blocktrans with attachment.original_filename as filename %}
            You can remove a reference to a file, but it will retain its references on other articles.
            {% endblocktrans %}
          </p>
          <form method="POST" class="form-horizontal" id="attachment_form" enctype="multipart/form-data">
          {% wiki_form form %}
          <div class="form-actions">
            <a href="{% url 'wiki:attachments_index' path=urlpath.path %}" class="btn">
              <span class="icon-arrow-left"></span>
              {% trans "Go back" %}
            </a>
            <button class="btn btn-danger btn-large">
              <span class="icon-upload"></span>
              {% trans "Remove reference" %}
            </button>
          </div>
        </form>
        
        {% endif %}
        
      </div>
    </div>

    <div class="tabbable tabs-below" style="margin-top: 20px;">
      <ul class="nav nav-tabs">
        <li style="margin-top: 10px;"><em>{% trans "Article last modified:" %} {{ article.current_revision.modified }}</em></li>
      </ul>
    </div>
    
  {% else %}
    {% trans "An article for this path does not exist." %}
  {% endif %}
  
{% endblock %}

